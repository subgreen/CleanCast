<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>CleanCast</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body {
        margin: 0;
        padding: 0;
        background: #000;
        color: #fff;
        font-family: Arial, sans-serif;
        display: flex;
        height: 100vh;
        overflow: hidden;
    }

    /* Left queue */
    #queue {
        width: 320px;
        background: #111;
        border-right: 2px solid #900;
        overflow-y: auto;
        padding: 20px;
    }

    .queue-item {
        background: #900;
        padding: 12px;
        margin-bottom: 12px;
        border-radius: 8px;
        cursor: pointer;
        transition: 0.2s;
    }

    .queue-item:hover {
        background: #b00;
    }

    /* Main player area */
    #main {
        flex: 1;
        display: flex;
        flex-direction: column;
        padding: 20px;
    }

    #input-area {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
    }

    #url-input {
        flex: 1;
        padding: 10px;
        font-size: 16px;
        border-radius: 6px;
        border: 2px solid #900;
        background: #000;
        color: #fff;
    }

    #add-btn {
        padding: 10px 20px;
        background: #900;
        border: none;
        border-radius: 6px;
        color: #fff;
        font-size: 16px;
        cursor: pointer;
    }

    #add-btn:hover {
        background: #b00;
    }

    iframe {
        width: 100%;
        height: calc(100% - 80px);
        border: none;
        border-radius: 12px;
        background: #000;
    }
</style>
</head>
<body>

<!-- LEFT QUEUE -->
<div id="queue">
    <h2>Queue</h2>
</div>

<!-- MAIN PLAYER -->
<div id="main">
    <div id="input-area">
        <input id="url-input" placeholder="Paste YouTube / Shorts / Music link">
        <button id="add-btn">Add</button>
    </div>

    <iframe id="player" allowfullscreen></iframe>
</div>

<script>
function extractVideoID(url) {
    // Handle Shorts
    if (url.includes("shorts/")) {
        return url.split("shorts/")[1].split("?")[0];
    }

    // Handle normal YouTube links
    const ytRegex = /(?:v=|youtu\.be\/)([\w-]{11})/;
    const match = url.match(ytRegex);
    return match ? match[1] : null;
}

async function fetchTitle(url) {
    try {
        const oembedURL = "https://www.youtube.com/oembed?url=" + encodeURIComponent(url) + "&format=json";
        const res = await fetch(oembedURL);
        if (!res.ok) throw "";
        const data = await res.json();
        return data.title;
    } catch {
        return "Unknown Title";
    }
}

function createEmbedURL(videoID) {
    return `https://www.youtube.com/embed/${videoID}?autoplay=1`;
}

async function addToQueue(url) {
    const videoID = extractVideoID(url);
    if (!videoID) return alert("Invalid YouTube link.");

    const title = await fetchTitle(url);

    const item = document.createElement("div");
    item.className = "queue-item";
    item.textContent = title;
    item.onclick = () => play(videoID);

    document.getElementById("queue").appendChild(item);
}

function play(videoID) {
    document.getElementById("player").src = createEmbedURL(videoID);
}

document.getElementById("add-btn").onclick = () => {
    const url = document.getElementById("url-input").value.trim();
    if (url) {
        addToQueue(url);
        document.getElementById("url-input").value = "";
    }
};
</script>

</body>
</html>
